databases:
  - name: nxworks-db
    databaseName: nxworks
    user: nxworks
    plan: free
    region: frankfurt

services:
  - type: web
    name: nxworks
    runtime: node
    plan: free
    region: frankfurt
    buildCommand: cd client && npm ci --include=dev && npm run build && cd ../server && npm ci && npm run db:init
    startCommand: cd server && node src/index.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: DATABASE_URL
        fromDatabase:
          name: nxworks-db
          property: connectionString
      - key: ANTHROPIC_API_KEY
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: AWS_ACCESS_KEY_ID
        sync: false
      - key: AWS_SECRET_ACCESS_KEY
        sync: false
      - key: AWS_S3_BUCKET
        sync: false
      - key: AWS_REGION
        value: ap-south-1
